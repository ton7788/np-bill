<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NP-Bill | เข้าสู่ระบบ</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #1a73e8; --bg: #f8f9fa; }
        body { font-family: 'Sarabun', sans-serif; background: var(--bg); display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .card { background: white; padding: 40px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); width: 100%; max-width: 350px; text-align: center; }
        h2 { color: #202124; margin-bottom: 8px; }
        p { color: #5f6368; font-size: 14px; margin-bottom: 24px; }
        input { width: 100%; padding: 12px; margin-bottom: 16px; border: 1px solid #dadce0; border-radius: 8px; font-size: 16px; box-sizing: border-box; text-align: center; letter-spacing: 5px; }
        button { width: 100%; padding: 12px; background: var(--primary); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        button:hover { background: #1557b0; }
    </style>
</head>
<body>
    <div class="card">
        <h2>NP-Bill</h2>
        <p>กรุณาใส่รหัส PIN เพื่อเข้าใช้งาน</p>
        <input type="password" id="pin" placeholder="••••••" maxlength="6" inputmode="numeric">
        <button onclick="login()">เข้าสู่ระบบ</button>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyAeXE8OJWnbrQ66L9_YW4HrMm-3EhXn0Ao",
            authDomain: "np-bill.firebaseapp.com",
            databaseURL: "https://np-bill-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "np-bill",
            storageBucket: "np-bill.firebasestorage.app",
            messagingSenderId: "516956569692",
            appId: "1:516956569692:web:961931e70b83a314072699"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        window.login = async () => {
            const pinVal = document.getElementById("pin").value;
            const snapshot = await get(ref(db, "staff/" + pinVal));
            if(snapshot.exists()){
                localStorage.setItem("user", JSON.stringify(snapshot.val()));
                location.href = "staff.html";
            } else {
                alert("รหัส PIN ไม่ถูกต้อง");
            }
        };
    </script>
</body>
</html>
